<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Reporting Automation - Automated report generation, scheduled delivery, and dashboard updates.">
    <title>Reporting Automation | VM Docs</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
</head>
<body>
    <div class="reading-progress">
        <div class="reading-progress-bar"></div>
    </div>
    
    <button class="mobile-menu-toggle" aria-label="Toggle menu">‚ò∞</button>
    
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="sidebar-logo-icon">üõ°Ô∏è</div>
                    <div class="sidebar-logo-text"><span>VM</span>DOCS</div>
                </a>
            </div>
                                    <nav class="sidebar-nav">
                <div class="nav-section collapsed" data-section="1">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üìö</span>
                        <span>1. Fundamentals</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="1-1-introduction.html" class="nav-item">1.1 Introduction</a>
                        <a href="1-2-program-framework.html" class="nav-item">1.2 Program Framework</a>
                        <a href="1-3-scoring-systems.html" class="nav-item">1.3 Scoring Systems</a>
                        <a href="1-4-compliance.html" class="nav-item">1.4 Compliance</a>
                        <a href="1-5-metrics-kpis.html" class="nav-item">1.5 Metrics & KPIs</a>
                    </div>
                </div>
                
                <div class="nav-section collapsed" data-section="2">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üîç</span>
                        <span>2. Scanning</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="2-1-scanner-types.html" class="nav-item">2.1 Scanner Types</a>
                        <a href="2-2-nessus.html" class="nav-item">2.2 Nessus</a>
                        <a href="2-3-qualys.html" class="nav-item">2.3 Qualys</a>
                        <a href="2-4-rapid7.html" class="nav-item">2.4 Rapid7</a>
                        <a href="2-5-defender.html" class="nav-item">2.5 Defender VM</a>
                        <a href="2-6-opensource.html" class="nav-item">2.6 Open Source</a>
                        <a href="2-7-best-practices.html" class="nav-item">2.7 Best Practices</a>
                        <a href="2-8-authenticated.html" class="nav-item">2.8 Authenticated</a>
                        <a href="2-9-cloud-container.html" class="nav-item">2.9 Cloud/Container</a>
                        <a href="2-10-webapp.html" class="nav-item">2.10 Web App</a>
                    </div>
                </div>
                
                <div class="nav-section collapsed" data-section="3">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üì¶</span>
                        <span>3. Asset Discovery</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="3-1-discovery-methods.html" class="nav-item">3.1 Discovery Methods</a>
                        <a href="3-2-inventory-management.html" class="nav-item">3.2 Inventory</a>
                        <a href="3-3-cmdb-integration.html" class="nav-item">3.3 CMDB Integration</a>
                        <a href="3-4-cloud-discovery.html" class="nav-item">3.4 Cloud Discovery</a>
                        <a href="3-5-shadow-it.html" class="nav-item">3.5 Shadow IT</a>
                        <a href="3-6-classification.html" class="nav-item">3.6 Classification</a>
                    </div>
                </div>
                
                <div class="nav-section collapsed" data-section="4">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üéØ</span>
                        <span>4. Analysis</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="4-1-prioritization.html" class="nav-item">4.1 Prioritization</a>
                        <a href="4-2-risk-scoring.html" class="nav-item">4.2 Risk Scoring</a>
                        <a href="4-3-threat-intel.html" class="nav-item">4.3 Threat Intel</a>
                        <a href="4-4-exploit-prediction.html" class="nav-item">4.4 Exploit Prediction</a>
                        <a href="4-5-business-context.html" class="nav-item">4.5 Business Context</a>
                        <a href="4-6-exceptions.html" class="nav-item">4.6 Exceptions</a>
                    </div>
                </div>
                
                <div class="nav-section collapsed" data-section="5">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üîß</span>
                        <span>5. Remediation</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="5-1-remediation-strategies.html" class="nav-item">5.1 Strategies</a>
                        <a href="5-2-patch-management.html" class="nav-item">5.2 Patch Mgmt</a>
                        <a href="5-3-change-management.html" class="nav-item">5.3 Change Mgmt</a>
                        <a href="5-4-ticket-workflows.html" class="nav-item">5.4 Ticket Workflows</a>
                        <a href="5-5-sla-management.html" class="nav-item">5.5 SLA Mgmt</a>
                        <a href="5-6-verification.html" class="nav-item">5.6 Verification</a>
                        <a href="5-7-rollback.html" class="nav-item">5.7 Rollback</a>
                        <a href="5-8-metrics.html" class="nav-item">5.8 Metrics</a>
                    </div>
                </div>
                
                <div class="nav-section " data-section="6">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">‚ö°</span>
                        <span>6. Automation</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="6-1-soar-integration.html" class="nav-item">6.1 SOAR</a>
                        <a href="6-2-ticketing-integration.html" class="nav-item">6.2 Ticketing</a>
                        <a href="6-3-api-integration.html" class="nav-item">6.3 API Integration</a>
                        <a href="6-4-workflow-automation.html" class="nav-item">6.4 Workflows</a>
                        <a href="6-5-reporting-automation.html" class="nav-item active">6.5 Report Automation</a>
                        <a href="6-6-notifications.html" class="nav-item">6.6 Notifications</a>
                        <a href="6-7-cicd-integration.html" class="nav-item">6.7 CI/CD</a>
                    </div>
                </div>
                
                <div class="nav-section collapsed" data-section="7">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üêõ</span>
                        <span>7. Vuln Types</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="7-1-os-vulnerabilities.html" class="nav-item">7.1 OS Vulns</a>
                        <a href="7-2-application-vulns.html" class="nav-item">7.2 Applications</a>
                        <a href="7-3-network-device-vulns.html" class="nav-item">7.3 Network Devices</a>
                        <a href="7-4-web-application-vulns.html" class="nav-item">7.4 Web Apps</a>
                        <a href="7-5-container-vulns.html" class="nav-item">7.5 Containers</a>
                        <a href="7-6-cloud-vulns.html" class="nav-item">7.6 Cloud</a>
                        <a href="7-7-database-vulns.html" class="nav-item">7.7 Databases</a>
                        <a href="7-8-iot-ot-vulns.html" class="nav-item">7.8 IoT/OT</a>
                    </div>
                </div>
                
                <div class="nav-section collapsed" data-section="8">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üìä</span>
                        <span>8. Reporting</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="8-1-dashboards.html" class="nav-item">8.1 Dashboards</a>
                        <a href="8-2-executive-reporting.html" class="nav-item">8.2 Executive</a>
                        <a href="8-3-operational-reporting.html" class="nav-item">8.3 Operational</a>
                        <a href="8-4-compliance-reporting.html" class="nav-item">8.4 Compliance</a>
                        <a href="8-5-kpis-metrics.html" class="nav-item">8.5 KPIs</a>
                    </div>
                </div>
                
                <div class="nav-section collapsed" data-section="9">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üîå</span>
                        <span>9. Tools Deep Dive</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="9-1-splunk-vm.html" class="nav-item">9.1 Splunk</a>
                        <a href="9-2-sentinel-vm.html" class="nav-item">9.2 Sentinel</a>
                        <a href="9-3-cortex-xsoar.html" class="nav-item">9.3 XSOAR</a>
                        <a href="9-4-tenable.html" class="nav-item">9.4 Tenable</a>
                        <a href="9-5-qualys.html" class="nav-item">9.5 Qualys</a>
                    </div>
                </div>
                
                <div class="nav-section collapsed0" data-section="10">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üéØ</span>
                        <span>10. Interview Prep</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="10-1-common-questions.html" class="nav-item">10.1 Common Questions</a>
                        <a href="10-2-scenario-questions.html" class="nav-item">10.2 Scenarios</a>
                        <a href="10-3-technical-deep-dive.html" class="nav-item">10.3 Technical</a>
                        <a href="10-4-study-guide.html" class="nav-item">10.4 Study Guide</a>
                    </div>
                </div>
            </nav>
        </aside>
        
        <main class="main-content">
            <div class="content-wrapper">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="6-1-soar-integration.html">Section 6: Automation</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span class="breadcrumb-current">Reporting Automation</span>
                </nav>
                
                <header class="page-header">
                    <h1>Reporting Automation</h1>
                    <div class="page-meta">
                        <span class="page-meta-item">üìñ Section 6.5</span>
                        <span class="page-meta-item">‚è±Ô∏è 12 min read</span>
                    </div>
                </header>
                
                <div class="info-box overview" data-label="Overview">
                    <div class="info-box-title">üìò What You'll Learn</div>
                    <p>
                        This page covers automating vulnerability reports including scheduled generation, 
                        email delivery, and integrating with business intelligence tools.
                    </p>
                </div>
                
                <h2>Automated Report Generation</h2>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">Python</span>
                        <button class="code-block-copy"><span>üìã</span> Copy</button>
                    </div>
                    <pre><code>"""
Automated Vulnerability Reporting
Generate and distribute scheduled reports.
"""

from datetime import datetime, timedelta
from typing import Dict, List
import pandas as pd
from jinja2 import Environment, FileSystemLoader
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.application import MIMEApplication


class VulnReportGenerator:
    """Generate vulnerability management reports."""
    
    def __init__(self, data_source, template_dir: str = 'templates'):
        self.data = data_source
        self.env = Environment(loader=FileSystemLoader(template_dir))
    
    def generate_executive_summary(self, period_days: int = 30) -> Dict:
        """Generate executive summary metrics."""
        
        end_date = datetime.now()
        start_date = end_date - timedelta(days=period_days)
        
        # Current state
        current_vulns = self.data.get_open_vulnerabilities()
        
        metrics = {
            'report_date': end_date.strftime('%Y-%m-%d'),
            'period': f'{period_days} days',
            
            # Current state
            'total_open': len(current_vulns),
            'critical_open': sum(1 for v in current_vulns if v['severity'] == 'Critical'),
            'high_open': sum(1 for v in current_vulns if v['severity'] == 'High'),
            'kev_open': sum(1 for v in current_vulns if v.get('cisa_kev')),
            
            # Trend data
            'new_this_period': self.data.count_vulns_added(start_date, end_date),
            'remediated_this_period': self.data.count_vulns_remediated(start_date, end_date),
            'net_change': None,  # Calculated below
            
            # SLA compliance
            'sla_compliance_critical': self.data.get_sla_compliance('Critical'),
            'sla_compliance_high': self.data.get_sla_compliance('High'),
            
            # Risk metrics
            'avg_age_critical': self.data.get_avg_age('Critical'),
            'mttr_critical': self.data.get_mttr('Critical'),
            
            # Asset coverage
            'assets_scanned': self.data.get_assets_scanned_count(),
            'scan_coverage_pct': self.data.get_scan_coverage()
        }
        
        metrics['net_change'] = metrics['new_this_period'] - metrics['remediated_this_period']
        
        return metrics
    
    def generate_team_report(self, team: str) -> Dict:
        """Generate team-specific vulnerability report."""
        
        team_vulns = self.data.get_vulns_by_owner(team)
        
        return {
            'team': team,
            'total_vulns': len(team_vulns),
            'critical': sum(1 for v in team_vulns if v['severity'] == 'Critical'),
            'high': sum(1 for v in team_vulns if v['severity'] == 'High'),
            'overdue': sum(1 for v in team_vulns if v.get('sla_breached')),
            'approaching_sla': sum(1 for v in team_vulns 
                                   if v.get('days_to_sla', 999) <= 7),
            'vulnerabilities': team_vulns[:50]  # Top 50 for detail
        }
    
    def render_html_report(self, template_name: str, data: Dict) -> str:
        """Render report using Jinja2 template."""
        template = self.env.get_template(template_name)
        return template.render(**data)
    
    def generate_csv_export(self, vulns: List[Dict]) -> str:
        """Export vulnerabilities to CSV."""
        df = pd.DataFrame(vulns)
        return df.to_csv(index=False)


class ReportDistributor:
    """Distribute reports via email."""
    
    def __init__(self, smtp_server: str, smtp_port: int,
                 username: str, password: str):
        self.smtp_server = smtp_server
        self.smtp_port = smtp_port
        self.username = username
        self.password = password
    
    def send_report(self, recipients: List[str], subject: str,
                    html_body: str, attachments: List[Dict] = None):
        """Send report via email."""
        
        msg = MIMEMultipart('alternative')
        msg['Subject'] = subject
        msg['From'] = self.username
        msg['To'] = ', '.join(recipients)
        
        # HTML body
        html_part = MIMEText(html_body, 'html')
        msg.attach(html_part)
        
        # Attachments
        if attachments:
            for attachment in attachments:
                part = MIMEApplication(
                    attachment['data'],
                    Name=attachment['filename']
                )
                part['Content-Disposition'] = f'attachment; filename="{attachment["filename"]}"'
                msg.attach(part)
        
        # Send
        with smtplib.SMTP(self.smtp_server, self.smtp_port) as server:
            server.starttls()
            server.login(self.username, self.password)
            server.send_message(msg)


# Scheduled report workflow
def weekly_executive_report():
    """Generate and send weekly executive report."""
    
    generator = VulnReportGenerator(data_source)
    distributor = ReportDistributor(smtp_config)
    
    # Generate metrics
    metrics = generator.generate_executive_summary(period_days=7)
    
    # Render HTML
    html_report = generator.render_html_report('executive_summary.html', metrics)
    
    # Send to executives
    distributor.send_report(
        recipients=['ciso@company.com', 'vp-it@company.com'],
        subject=f'Weekly Vulnerability Report - {metrics["report_date"]}',
        html_body=html_report
    )</code></pre>
                </div>
                
                <div class="info-box interview" data-label="Interview">
                    <div class="info-box-title">üí° Interview Question</div>
                    <p>
                        <strong>"How do you automate vulnerability reporting?"</strong><br><br>
                        Sample answer: "I automate reports at multiple levels. Weekly executive summaries 
                        go to leadership with high-level metrics like SLA compliance and trend data. Team 
                        reports go to managers with their specific vulnerabilities and upcoming SLA deadlines. 
                        I use Python with Jinja2 templates for HTML generation and schedule distribution via 
                        email. For real-time metrics, I push data to Splunk dashboards that update automatically. 
                        This eliminates manual report creation and ensures consistent, timely delivery."
                    </p>
                </div>
                
                <h2>Summary</h2>
                
                <p>
                    Automated reporting ensures stakeholders receive consistent, timely vulnerability 
                    information. Generate reports at appropriate frequencies for each audience and 
                    automate distribution to eliminate manual effort.
                </p>
                
                <nav class="page-navigation">
                    <a href="6-4-workflow-automation.html" class="page-nav-link prev">
                        <span class="page-nav-label">‚Üê Previous</span>
                        <span class="page-nav-title">Workflow Automation</span>
                    </a>
                    <a href="6-6-notifications.html" class="page-nav-link next">
                        <span class="page-nav-label">Next ‚Üí</span>
                        <span class="page-nav-title">Notification Systems</span>
                    </a>
                </nav>
            </div>
        </main>
    </div>
    
    <script src="main.js"></script>
</body>
</html>
