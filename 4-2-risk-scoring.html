<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Risk Scoring Models - CVSS, EPSS, SSVC, VPR, TruRisk, and custom scoring approaches for vulnerability prioritization.">
    <title>Risk Scoring Models | VM Docs</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ›¡ï¸</text></svg>">
</head>
<body>
    <div class="reading-progress">
        <div class="reading-progress-bar"></div>
    </div>
    
    <button class="mobile-menu-toggle" aria-label="Toggle menu">â˜°</button>
    
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="sidebar-logo-icon">ğŸ›¡ï¸</div>
                    <div class="sidebar-logo-text"><span>VM</span>DOCS</div>
                </a>
            </div>
                                    <nav class="sidebar-nav">
                <div class="nav-section collapsed" data-section="1">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ“š</span>
                        <span>1. Fundamentals</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="1-1-introduction.html" class="nav-item">1.1 Introduction</a>
                        <a href="1-2-program-framework.html" class="nav-item">1.2 Framework</a>
                        <a href="1-3-scoring-systems.html" class="nav-item">1.3 Scoring</a>
                        <a href="1-4-compliance.html" class="nav-item">1.4 Compliance</a>
                        <a href="1-5-metrics-kpis.html" class="nav-item">1.5 Metrics</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="2">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ”</span>
                        <span>2. Scanning</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="2-1-scanner-types.html" class="nav-item">2.1 Scanner Types</a>
                        <a href="2-2-nessus.html" class="nav-item">2.2 Nessus</a>
                        <a href="2-3-qualys.html" class="nav-item">2.3 Qualys</a>
                        <a href="2-4-rapid7.html" class="nav-item">2.4 Rapid7</a>
                        <a href="2-5-defender.html" class="nav-item">2.5 Defender</a>
                        <a href="2-6-opensource.html" class="nav-item">2.6 Open Source</a>
                        <a href="2-7-best-practices.html" class="nav-item">2.7 Best Practices</a>
                        <a href="2-8-authenticated.html" class="nav-item">2.8 Authenticated</a>
                        <a href="2-9-cloud-container.html" class="nav-item">2.9 Cloud/Container</a>
                        <a href="2-10-webapp.html" class="nav-item">2.10 Web App</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="3">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ“¦</span>
                        <span>3. Assets</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="3-1-discovery-methods.html" class="nav-item">3.1 Discovery</a>
                        <a href="3-2-inventory-management.html" class="nav-item">3.2 Inventory</a>
                        <a href="3-3-cmdb-integration.html" class="nav-item">3.3 CMDB</a>
                        <a href="3-4-cloud-discovery.html" class="nav-item">3.4 Cloud</a>
                        <a href="3-5-shadow-it.html" class="nav-item">3.5 Shadow IT</a>
                        <a href="3-6-classification.html" class="nav-item">3.6 Classification</a>
                        <a href="3-7-attack-surface.html" class="nav-item">3.7 Attack Surface</a>
                    </div>
                </div>
                <div class="nav-section" data-section="4">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ¯</span>
                        <span>4. Analysis</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="4-1-prioritization.html" class="nav-item">4.1 Prioritization</a>
                        <a href="4-2-risk-scoring.html" class="nav-item active">4.2 Risk Scoring</a>
                        <a href="4-3-threat-intel.html" class="nav-item">4.3 Threat Intel</a>
                        <a href="4-4-exploit-prediction.html" class="nav-item">4.4 EPSS</a>
                        <a href="4-5-business-context.html" class="nav-item">4.5 Business Context</a>
                        <a href="4-6-exceptions.html" class="nav-item">4.6 Exceptions</a>
                        <a href="4-7-risk-acceptance.html" class="nav-item">4.7 Risk Acceptance</a>
                        <a href="4-8-zero-day-response.html" class="nav-item">4.8 Zero-Day</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="5">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ”§</span>
                        <span>5. Remediation</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="5-1-remediation-strategies.html" class="nav-item">5.1 Strategies</a>
                        <a href="5-2-patch-management.html" class="nav-item">5.2 Patching</a>
                        <a href="5-3-change-management.html" class="nav-item">5.3 Change Mgmt</a>
                        <a href="5-4-ticket-workflows.html" class="nav-item">5.4 Tickets</a>
                        <a href="5-5-sla-management.html" class="nav-item">5.5 SLAs</a>
                        <a href="5-6-verification.html" class="nav-item">5.6 Verification</a>
                        <a href="5-7-rollback.html" class="nav-item">5.7 Rollback</a>
                        <a href="5-8-metrics.html" class="nav-item">5.8 Metrics</a>
                        <a href="5-9-compensating-controls.html" class="nav-item">5.9 Compensating</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="6">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">âš¡</span>
                        <span>6. Automation</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="6-1-soar-integration.html" class="nav-item">6.1 SOAR</a>
                        <a href="6-2-ticketing-integration.html" class="nav-item">6.2 Ticketing</a>
                        <a href="6-3-api-integration.html" class="nav-item">6.3 APIs</a>
                        <a href="6-4-workflow-automation.html" class="nav-item">6.4 Workflows</a>
                        <a href="6-5-reporting-automation.html" class="nav-item">6.5 Reports</a>
                        <a href="6-6-notifications.html" class="nav-item">6.6 Alerts</a>
                        <a href="6-7-cicd-integration.html" class="nav-item">6.7 CI/CD</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="7">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ›</span>
                        <span>7. Vuln Types</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="7-1-os-vulnerabilities.html" class="nav-item">7.1 OS</a>
                        <a href="7-2-application-vulns.html" class="nav-item">7.2 Apps</a>
                        <a href="7-3-network-device-vulns.html" class="nav-item">7.3 Network</a>
                        <a href="7-4-web-application-vulns.html" class="nav-item">7.4 Web</a>
                        <a href="7-5-container-vulns.html" class="nav-item">7.5 Containers</a>
                        <a href="7-6-cloud-vulns.html" class="nav-item">7.6 Cloud</a>
                        <a href="7-7-database-vulns.html" class="nav-item">7.7 Database</a>
                        <a href="7-8-iot-ot-vulns.html" class="nav-item">7.8 IoT/OT</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="8">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ“Š</span>
                        <span>8. Reporting</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="8-1-dashboards.html" class="nav-item">8.1 Dashboards</a>
                        <a href="8-2-executive-reporting.html" class="nav-item">8.2 Executive</a>
                        <a href="8-3-operational-reporting.html" class="nav-item">8.3 Operational</a>
                        <a href="8-4-compliance-reporting.html" class="nav-item">8.4 Compliance</a>
                        <a href="8-5-kpis-metrics.html" class="nav-item">8.5 KPIs</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="9">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ”Œ</span>
                        <span>9. Tools</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="9-1-splunk-vm.html" class="nav-item">9.1 Splunk</a>
                        <a href="9-2-sentinel-vm.html" class="nav-item">9.2 Sentinel</a>
                        <a href="9-3-cortex-xsoar.html" class="nav-item">9.3 XSOAR</a>
                        <a href="9-4-tenable.html" class="nav-item">9.4 Tenable</a>
                        <a href="9-5-qualys.html" class="nav-item">9.5 Qualys</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="10">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ“</span>
                        <span>10. Interview</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="10-1-common-questions.html" class="nav-item">10.1 Q&A</a>
                        <a href="10-2-scenario-questions.html" class="nav-item">10.2 Scenarios</a>
                        <a href="10-3-technical-deep-dive.html" class="nav-item">10.3 Technical</a>
                        <a href="10-4-study-guide.html" class="nav-item">10.4 Study Guide</a>
                        <a href="10-5-interview-scenarios.html" class="nav-item">10.5 Deep Dives</a>
                    </div>
                </div>
            </nav>
        </aside>
        
        <main class="main-content">
            <div class="content-wrapper">

                <div class="memory-box">
                    <div class="memory-box-title">ğŸ§  Risk Scoring Models</div>
                    <p>
                        <strong>CVSS</strong> = Base severity (0-10)<br>
                        <strong>EPSS</strong> = Exploit probability (0-1)<br>
                        <strong>VPR</strong> = Tenable contextual risk<br>
                        <strong>TruRisk</strong> = Qualys contextual risk<br>
                        Formula: Risk = Severity Ã— Exploitability Ã— Asset Value
                    </p>
                </div>

                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">â€º</span>
                    <a href="4-1-prioritization.html">Section 4: Analysis & Priority</a>
                    <span class="breadcrumb-separator">â€º</span>
                    <span class="breadcrumb-current">Risk Scoring Models</span>
                </nav>
                
                <header class="page-header">
                    <h1>Risk Scoring Models</h1>
                    <div class="page-meta">
                        <span class="page-meta-item">ğŸ“– Section 4.2</span>
                        <span class="page-meta-item">â±ï¸ 20 min read</span>
                    </div>
                </header>
                
                <div class="info-box overview" data-label="Overview">
                    <div class="info-box-title">ğŸ“˜ What You'll Learn</div>
                    <p>
                        This page covers major vulnerability scoring models including CVSS v3.1/v4.0, 
                        EPSS (Exploit Prediction Scoring System), SSVC (Stakeholder-Specific Vulnerability 
                        Categorization), vendor scores like VPR and TruRisk, and building custom scoring.
                    </p>
                </div>
                
                <h2>Scoring Models Comparison</h2>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">Text</span>
                        <button class="code-block-copy"><span>ğŸ“‹</span> Copy</button>
                    </div>
                    <pre><code>VULNERABILITY SCORING MODELS COMPARISON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Model       â”‚ Type        â”‚ Range         â”‚ Best For                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CVSS        â”‚ Severity    â”‚ 0.0-10.0      â”‚ Standardized severity      â”‚
â”‚ EPSS        â”‚ Probability â”‚ 0.0-1.0 (%)   â”‚ Exploit likelihood         â”‚
â”‚ SSVC        â”‚ Decision    â”‚ Categories    â”‚ Action-based decisions     â”‚
â”‚ VPR         â”‚ Risk        â”‚ 0.0-10.0      â”‚ Tenable users              â”‚
â”‚ TruRisk     â”‚ Risk        â”‚ 0-1000        â”‚ Qualys users               â”‚
â”‚ Real Risk   â”‚ Risk        â”‚ 0-1000        â”‚ Rapid7 users               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

KEY INSIGHT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ CVSS tells you "how bad" (severity)
â€¢ EPSS tells you "how likely" (exploitation probability)
â€¢ SSVC tells you "what to do" (action)
â€¢ Vendor scores combine multiple factors

RECOMMENDED: Use multiple models together
  CVSS (severity) + EPSS (likelihood) + Asset Criticality (impact)</code></pre>
                </div>
                
                <h2>CVSS (Common Vulnerability Scoring System)</h2>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">Text</span>
                        <button class="code-block-copy"><span>ğŸ“‹</span> Copy</button>
                    </div>
                    <pre><code>CVSS v3.1 COMPONENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BASE SCORE (Intrinsic vulnerability characteristics)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Exploitability Metrics:
  â€¢ Attack Vector (AV): Network/Adjacent/Local/Physical
  â€¢ Attack Complexity (AC): Low/High
  â€¢ Privileges Required (PR): None/Low/High
  â€¢ User Interaction (UI): None/Required

Impact Metrics:
  â€¢ Confidentiality (C): None/Low/High
  â€¢ Integrity (I): None/Low/High
  â€¢ Availability (A): None/Low/High
  â€¢ Scope (S): Unchanged/Changed

TEMPORAL SCORE (Changes over time)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ Exploit Code Maturity (E): Not Defined/Unproven/PoC/Functional/High
  â€¢ Remediation Level (RL): Not Defined/Official Fix/Temp Fix/Workaround
  â€¢ Report Confidence (RC): Not Defined/Unknown/Reasonable/Confirmed

ENVIRONMENTAL SCORE (Your specific environment)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ Modified Base Metrics (adjust AV, AC, etc. for your context)
  â€¢ CIA Requirements (your organization's requirements)

SEVERITY RATINGS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  0.0           = None
  0.1 - 3.9     = Low
  4.0 - 6.9     = Medium
  7.0 - 8.9     = High
  9.0 - 10.0    = Critical</code></pre>
                </div>
                
                <h3>CVSS v4.0 Changes</h3>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">Text</span>
                        <button class="code-block-copy"><span>ğŸ“‹</span> Copy</button>
                    </div>
                    <pre><code>CVSS v4.0 KEY CHANGES (Released November 2023)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NEW METRIC GROUPS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Base (B): Intrinsic characteristics
â€¢ Threat (T): Replaces Temporal, focuses on exploitation state
â€¢ Environmental (E): Organization-specific adjustments
â€¢ Supplemental (S): Additional context (not in score calculation)

KEY IMPROVEMENTS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Attack Requirements (AT)
   - New metric capturing preconditions for attack
   - Values: None, Present
   
2. Revised User Interaction (UI)
   - Values: None, Passive, Active
   - Better granularity for social engineering attacks

3. Subsequent System Impact
   - Separates impact on vulnerable system vs. downstream systems
   - Confidentiality (VC/SC), Integrity (VI/SI), Availability (VA/SA)

4. Supplemental Metrics (Advisory Only)
   - Safety, Automatable, Recovery, Provider Urgency
   - Not calculated into score

NAMING CONVENTION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CVSS-B   = Base only
CVSS-BT  = Base + Threat
CVSS-BE  = Base + Environmental
CVSS-BTE = Base + Threat + Environmental (full)</code></pre>
                </div>
                
                <h2>EPSS (Exploit Prediction Scoring System)</h2>
                
                <p>
                    EPSS predicts the probability that a vulnerability will be exploited in the wild 
                    within the next 30 days. It's maintained by FIRST.org and updated daily.
                </p>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">Python</span>
                        <button class="code-block-copy"><span>ğŸ“‹</span> Copy</button>
                    </div>
                    <pre><code>"""
EPSS API Integration
Retrieve exploit prediction scores for CVEs.
"""

import requests
from typing import Dict, List, Optional
from datetime import datetime


class EPSSClient:
    """Client for EPSS (Exploit Prediction Scoring System) API."""
    
    BASE_URL = "https://api.first.org/data/v1/epss"
    
    def get_score(self, cve_id: str) -> Optional[Dict]:
        """Get EPSS score for a single CVE."""
        response = requests.get(f"{self.BASE_URL}?cve={cve_id}")
        response.raise_for_status()
        
        data = response.json()
        if data.get('data'):
            return data['data'][0]
        return None
    
    def get_scores_batch(self, cve_ids: List[str]) -> Dict[str, Dict]:
        """Get EPSS scores for multiple CVEs."""
        # API supports comma-separated CVEs
        cve_param = ','.join(cve_ids[:100])  # Max 100 per request
        
        response = requests.get(f"{self.BASE_URL}?cve={cve_param}")
        response.raise_for_status()
        
        data = response.json()
        return {item['cve']: item for item in data.get('data', [])}
    
    def get_high_epss_cves(self, threshold: float = 0.1) -> List[Dict]:
        """Get CVEs above EPSS threshold."""
        response = requests.get(
            f"{self.BASE_URL}",
            params={'epss-gt': threshold, 'limit': 1000}
        )
        response.raise_for_status()
        
        return response.json().get('data', [])


def interpret_epss(epss_score: float) -> str:
    """Interpret EPSS score for prioritization."""
    if epss_score >= 0.7:
        return "Very High - Immediate attention required"
    elif epss_score >= 0.4:
        return "High - Prioritize remediation"
    elif epss_score >= 0.1:
        return "Moderate - Include in patching cycles"
    elif epss_score >= 0.01:
        return "Low - Standard remediation timeline"
    else:
        return "Very Low - May deprioritize"


# Example usage
client = EPSSClient()

# Get score for Log4Shell
score = client.get_score("CVE-2021-44228")
if score:
    epss = float(score['epss'])
    percentile = float(score['percentile'])
    print(f"CVE-2021-44228:")
    print(f"  EPSS: {epss:.2%} probability of exploitation")
    print(f"  Percentile: {percentile:.1%} (more likely than {percentile:.1%} of all CVEs)")
    print(f"  Interpretation: {interpret_epss(epss)}")</code></pre>
                </div>
                
                <h2>SSVC (Stakeholder-Specific Vulnerability Categorization)</h2>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">Text</span>
                        <button class="code-block-copy"><span>ğŸ“‹</span> Copy</button>
                    </div>
                    <pre><code>SSVC DECISION TREE (CISA Model)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SSVC provides ACTION-based decisions, not just scores.

DECISION POINTS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. EXPLOITATION STATUS
   â–¡ None - No evidence of active exploitation
   â–¡ PoC - Proof of concept exists
   â–¡ Active - Actively exploited in the wild

2. TECHNICAL IMPACT
   â–¡ Partial - Limited impact (e.g., DoS, info disclosure)
   â–¡ Total - Full system compromise possible

3. AUTOMATABLE
   â–¡ No - Requires manual steps or specific conditions
   â–¡ Yes - Can be automated/wormable

4. MISSION PREVALENCE (Your organization)
   â–¡ Minimal - Asset not essential to mission
   â–¡ Support - Asset supports mission functions
   â–¡ Essential - Asset is mission-critical

5. PUBLIC WELL-BEING IMPACT
   â–¡ Minimal - Limited public impact
   â–¡ Material - Significant public impact
   â–¡ Irreversible - Permanent public harm possible

DECISION OUTCOMES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TRACK     â”‚ Monitor, no immediate action needed                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  TRACK*    â”‚ Close monitoring, may require action soon             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ATTEND    â”‚ Action required, prioritize within standard process   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ACT       â”‚ Immediate action required, top priority               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
                </div>
                
                <h2>Vendor Risk Scores</h2>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">Text</span>
                        <button class="code-block-copy"><span>ğŸ“‹</span> Copy</button>
                    </div>
                    <pre><code>VENDOR RISK SCORING COMPARISON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TENABLE VPR (Vulnerability Priority Rating)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range: 0.1 - 10.0
Updates: Daily

Factors:
  â€¢ CVSS base score
  â€¢ Threat sources and intelligence
  â€¢ Exploit code maturity
  â€¢ Exploit availability
  â€¢ Age of vulnerability
  â€¢ Product coverage (how widespread)

Thresholds:
  9.0-10.0 = Critical (top 3%)
  7.0-8.9  = High
  4.0-6.9  = Medium
  0.1-3.9  = Low

QUALYS TRURISK
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range: 0 - 1000
Updates: Continuous

Factors:
  â€¢ CVSS score
  â€¢ Threat intelligence
  â€¢ Exploit maturity
  â€¢ Real-time threat indicators
  â€¢ Asset criticality (Tier 1-5)
  â€¢ Asset exposure
  â€¢ Malware correlation

Thresholds:
  850-1000 = Critical
  700-849  = High
  500-699  = Medium
  300-499  = Low
  0-299    = Minimal

RAPID7 REAL RISK
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range: 0 - 1000
Updates: Continuous

Factors:
  â€¢ CVSS score
  â€¢ Exploit availability
  â€¢ Malware kit presence
  â€¢ Active exploitation
  â€¢ Asset exposure level
  â€¢ Asset criticality tags
  â€¢ Temporal factors

Thresholds:
  900-1000 = Critical
  700-899  = High
  500-699  = Medium
  0-499    = Low</code></pre>
                </div>
                
                <h2>Building a Custom Scoring Model</h2>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">Python</span>
                        <button class="code-block-copy"><span>ğŸ“‹</span> Copy</button>
                    </div>
                    <pre><code>"""
Custom Risk Scoring Model
Combine multiple data sources into a single score.
"""

from dataclasses import dataclass
from typing import Dict, Optional
import math


@dataclass
class RiskScore:
    score: float           # 0-100
    severity: str          # Critical/High/Medium/Low
    contributing_factors: Dict[str, float]
    recommended_action: str


class CustomRiskScorer:
    """
    Custom risk scoring combining CVSS, EPSS, and business context.
    """
    
    def __init__(self, weights: Dict[str, float] = None):
        # Default weights (sum to 1.0)
        self.weights = weights or {
            'cvss_base': 0.15,
            'epss': 0.25,
            'exploit_maturity': 0.15,
            'asset_criticality': 0.25,
            'exposure': 0.15,
            'cisa_kev': 0.05
        }
    
    def calculate_risk(self, 
                       cvss: float,
                       epss: float,
                       exploit_maturity: str,
                       asset_criticality: int,
                       network_zone: str,
                       cisa_kev: bool) -> RiskScore:
        """
        Calculate composite risk score.
        
        Args:
            cvss: CVSS base score (0-10)
            epss: EPSS probability (0-1)
            exploit_maturity: 'none', 'poc', 'functional', 'weaponized'
            asset_criticality: Tier 1-4
            network_zone: 'internet', 'dmz', 'internal', 'isolated'
            cisa_kev: Whether in CISA KEV catalog
        
        Returns:
            RiskScore with composite score and interpretation
        """
        factors = {}
        
        # Normalize CVSS (0-10 â†’ 0-100)
        factors['cvss_base'] = (cvss / 10) * 100
        
        # Normalize EPSS (already 0-1, apply log scaling)
        # EPSS is often very low, log scale makes differences more visible
        if epss > 0:
            # Scale: 0.01 â†’ ~50, 0.1 â†’ ~75, 0.5 â†’ ~90
            factors['epss'] = min(100, 50 + (math.log10(epss * 100) * 25))
        else:
            factors['epss'] = 0
        
        # Exploit maturity score
        maturity_scores = {
            'none': 10,
            'poc': 50,
            'functional': 80,
            'weaponized': 100
        }
        factors['exploit_maturity'] = maturity_scores.get(exploit_maturity, 30)
        
        # Asset criticality (Tier 1=100, Tier 4=25)
        criticality_scores = {1: 100, 2: 75, 3: 50, 4: 25}
        factors['asset_criticality'] = criticality_scores.get(asset_criticality, 50)
        
        # Network exposure
        exposure_scores = {
            'internet': 100,
            'dmz': 80,
            'internal': 40,
            'isolated': 10
        }
        factors['exposure'] = exposure_scores.get(network_zone, 40)
        
        # CISA KEV (binary boost)
        factors['cisa_kev'] = 100 if cisa_kev else 0
        
        # Calculate weighted score
        score = sum(
            factors[k] * self.weights[k] 
            for k in self.weights
        )
        
        # Determine severity
        if score >= 80 or cisa_kev:
            severity = 'Critical'
            action = "Immediate remediation required (24-48 hours)"
        elif score >= 60:
            severity = 'High'
            action = "Prioritize remediation (7 days)"
        elif score >= 40:
            severity = 'Medium'
            action = "Standard remediation timeline (30 days)"
        else:
            severity = 'Low'
            action = "Address in regular maintenance cycles"
        
        return RiskScore(
            score=round(score, 1),
            severity=severity,
            contributing_factors=factors,
            recommended_action=action
        )


# Example
scorer = CustomRiskScorer()

# High-risk scenario
result = scorer.calculate_risk(
    cvss=9.8,
    epss=0.37,
    exploit_maturity='functional',
    asset_criticality=1,
    network_zone='internet',
    cisa_kev=True
)

print(f"Risk Score: {result.score}/100")
print(f"Severity: {result.severity}")
print(f"Action: {result.recommended_action}")
print(f"Factors: {result.contributing_factors}")</code></pre>
                </div>
                
                <div class="info-box interview" data-label="Interview">
                    <div class="info-box-title">ğŸ’¡ Interview Question</div>
                    <p>
                        <strong>"What's the difference between CVSS and EPSS, and when would you use each?"</strong><br><br>
                        Sample answer: "CVSS measures technical severityâ€”how bad the vulnerability is if exploited. 
                        EPSS measures probabilityâ€”the likelihood it will actually be exploited in the next 30 days. 
                        They answer different questions. A CVSS 9.8 vulnerability might have EPSS of 0.001 (unlikely 
                        to be exploited), while a CVSS 7.0 might have EPSS of 0.5 (actively exploited). I use both 
                        together: CVSS as the baseline impact score, EPSS to filter for real-world exploitation 
                        likelihood. This helps focus on the ~5% of vulns that are both severe AND likely to be 
                        exploited."
                    </p>
                </div>
                
                <h2>Summary</h2>
                
                <p>
                    Multiple scoring models exist because no single score captures all dimensions of 
                    vulnerability risk. Use CVSS for standardized severity, EPSS for exploitation 
                    probability, SSVC for decision support, and vendor scores for integrated risk views. 
                    The best approach combines multiple signals with asset context.
                </p>
                
                <nav class="page-navigation">
                    <a href="4-1-prioritization.html" class="page-nav-link prev">
                        <span class="page-nav-label">â† Previous</span>
                        <span class="page-nav-title">Prioritization</span>
                    </a>
                    <a href="4-3-threat-intel.html" class="page-nav-link next">
                        <span class="page-nav-label">Next â†’</span>
                        <span class="page-nav-title">Threat Intelligence</span>
                    </a>
                </nav>
            </div>
        </main>
    </div>
    
    <script src="main.js"></script>
</body>
</html>
