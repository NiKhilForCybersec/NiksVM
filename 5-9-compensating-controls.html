<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compensating Controls Deep Dive | VM Docs</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="sidebar-logo-icon">üõ°Ô∏è</div>
                    <div class="sidebar-logo-text"><span>VM</span>DOCS</div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section collapsed" data-section="1">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üìö</span>
                        <span>1. Fundamentals</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="1-1-introduction.html" class="nav-item">1.1 Introduction</a>
                        <a href="1-2-program-framework.html" class="nav-item">1.2 Framework</a>
                        <a href="1-3-scoring-systems.html" class="nav-item">1.3 Scoring</a>
                        <a href="1-4-compliance.html" class="nav-item">1.4 Compliance</a>
                        <a href="1-5-metrics-kpis.html" class="nav-item">1.5 Metrics</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="2">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üîç</span>
                        <span>2. Scanning</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="2-1-scanner-types.html" class="nav-item">2.1 Scanner Types</a>
                        <a href="2-2-nessus.html" class="nav-item">2.2 Nessus</a>
                        <a href="2-3-qualys.html" class="nav-item">2.3 Qualys</a>
                        <a href="2-4-rapid7.html" class="nav-item">2.4 Rapid7</a>
                        <a href="2-5-defender.html" class="nav-item">2.5 Defender</a>
                        <a href="2-6-opensource.html" class="nav-item">2.6 Open Source</a>
                        <a href="2-7-best-practices.html" class="nav-item">2.7 Best Practices</a>
                        <a href="2-8-authenticated.html" class="nav-item">2.8 Authenticated</a>
                        <a href="2-9-cloud-container.html" class="nav-item">2.9 Cloud/Container</a>
                        <a href="2-10-webapp.html" class="nav-item">2.10 Web App</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="3">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üì¶</span>
                        <span>3. Assets</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="3-1-discovery-methods.html" class="nav-item">3.1 Discovery</a>
                        <a href="3-2-inventory-management.html" class="nav-item">3.2 Inventory</a>
                        <a href="3-3-cmdb-integration.html" class="nav-item">3.3 CMDB</a>
                        <a href="3-4-cloud-discovery.html" class="nav-item">3.4 Cloud</a>
                        <a href="3-5-shadow-it.html" class="nav-item">3.5 Shadow IT</a>
                        <a href="3-6-classification.html" class="nav-item">3.6 Classification</a>
                        <a href="3-7-attack-surface.html" class="nav-item">3.7 Attack Surface</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="4">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üéØ</span>
                        <span>4. Analysis</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="4-1-prioritization.html" class="nav-item">4.1 Prioritization</a>
                        <a href="4-2-risk-scoring.html" class="nav-item">4.2 Risk Scoring</a>
                        <a href="4-3-threat-intel.html" class="nav-item">4.3 Threat Intel</a>
                        <a href="4-4-exploit-prediction.html" class="nav-item">4.4 EPSS</a>
                        <a href="4-5-business-context.html" class="nav-item">4.5 Business Context</a>
                        <a href="4-6-exceptions.html" class="nav-item">4.6 Exceptions</a>
                        <a href="4-7-risk-acceptance.html" class="nav-item">4.7 Risk Acceptance</a>
                        <a href="4-8-zero-day-response.html" class="nav-item">4.8 Zero-Day</a>
                    </div>
                </div>
                <div class="nav-section" data-section="5">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üîß</span>
                        <span>5. Remediation</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="5-1-remediation-strategies.html" class="nav-item">5.1 Strategies</a>
                        <a href="5-2-patch-management.html" class="nav-item">5.2 Patching</a>
                        <a href="5-3-change-management.html" class="nav-item">5.3 Change Mgmt</a>
                        <a href="5-4-ticket-workflows.html" class="nav-item">5.4 Tickets</a>
                        <a href="5-5-sla-management.html" class="nav-item">5.5 SLAs</a>
                        <a href="5-6-verification.html" class="nav-item">5.6 Verification</a>
                        <a href="5-7-rollback.html" class="nav-item">5.7 Rollback</a>
                        <a href="5-8-metrics.html" class="nav-item">5.8 Metrics</a>
                        <a href="5-9-compensating-controls.html" class="nav-item active">5.9 Compensating</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="6">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">‚ö°</span>
                        <span>6. Automation</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="6-1-soar-integration.html" class="nav-item">6.1 SOAR</a>
                        <a href="6-2-ticketing-integration.html" class="nav-item">6.2 Ticketing</a>
                        <a href="6-3-api-integration.html" class="nav-item">6.3 APIs</a>
                        <a href="6-4-workflow-automation.html" class="nav-item">6.4 Workflows</a>
                        <a href="6-5-reporting-automation.html" class="nav-item">6.5 Reports</a>
                        <a href="6-6-notifications.html" class="nav-item">6.6 Alerts</a>
                        <a href="6-7-cicd-integration.html" class="nav-item">6.7 CI/CD</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="7">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üêõ</span>
                        <span>7. Vuln Types</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="7-1-os-vulnerabilities.html" class="nav-item">7.1 OS</a>
                        <a href="7-2-application-vulns.html" class="nav-item">7.2 Apps</a>
                        <a href="7-3-network-device-vulns.html" class="nav-item">7.3 Network</a>
                        <a href="7-4-web-application-vulns.html" class="nav-item">7.4 Web</a>
                        <a href="7-5-container-vulns.html" class="nav-item">7.5 Containers</a>
                        <a href="7-6-cloud-vulns.html" class="nav-item">7.6 Cloud</a>
                        <a href="7-7-database-vulns.html" class="nav-item">7.7 Database</a>
                        <a href="7-8-iot-ot-vulns.html" class="nav-item">7.8 IoT/OT</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="8">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üìä</span>
                        <span>8. Reporting</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="8-1-dashboards.html" class="nav-item">8.1 Dashboards</a>
                        <a href="8-2-executive-reporting.html" class="nav-item">8.2 Executive</a>
                        <a href="8-3-operational-reporting.html" class="nav-item">8.3 Operational</a>
                        <a href="8-4-compliance-reporting.html" class="nav-item">8.4 Compliance</a>
                        <a href="8-5-kpis-metrics.html" class="nav-item">8.5 KPIs</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="9">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üîå</span>
                        <span>9. Tools</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="9-1-splunk-vm.html" class="nav-item">9.1 Splunk</a>
                        <a href="9-2-sentinel-vm.html" class="nav-item">9.2 Sentinel</a>
                        <a href="9-3-cortex-xsoar.html" class="nav-item">9.3 XSOAR</a>
                        <a href="9-4-tenable.html" class="nav-item">9.4 Tenable</a>
                        <a href="9-5-qualys.html" class="nav-item">9.5 Qualys</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="10">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">üéì</span>
                        <span>10. Interview</span>
                        <span class="nav-section-toggle">‚ñº</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="10-1-common-questions.html" class="nav-item">10.1 Q&A</a>
                        <a href="10-2-scenario-questions.html" class="nav-item">10.2 Scenarios</a>
                        <a href="10-3-technical-deep-dive.html" class="nav-item">10.3 Technical</a>
                        <a href="10-4-study-guide.html" class="nav-item">10.4 Study Guide</a>
                        <a href="10-5-interview-scenarios.html" class="nav-item">10.5 Deep Dives</a>
                    </div>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <div class="page-meta"><span class="page-section">Section 5: Remediation</span></div>
                <h1>Compensating Controls Deep Dive</h1>
                <p class="page-description">When you can't patch, what do you do? Master the art of compensating controls.</p>
            </div>

            <div class="content-body">
                
                <div class="eli5-box">
                    <strong>What is a Compensating Control?</strong><br><br>
                    Imagine your car's driver-side door lock is broken. You can't fix it right now because the part is on backorder. So you:<br><br>
                    üîí Park in a locked garage (network segmentation)<br>
                    üìπ Install a dashcam that alerts you (monitoring)<br>
                    üö® Add an extra car alarm (IPS/IDS)<br>
                    üìã Only drive to secure locations (access restrictions)<br><br>
                    <em>These are compensating controls - alternative security measures when you can't apply the ideal fix!</em>
                </div>

                <h2>When to Use Compensating Controls</h2>

                <div class="memory-box">
                    <div class="memory-box-title">üß† The "SNAP" Test</div>
                    <p>Use compensating controls when you <strong>can't patch</strong> because of:</p>
                    <div class="mnemonic">
                        <div class="mnemonic-letters">S N A P</div>
                        <div class="mnemonic-meaning">
                            <span>S</span>ystem too critical to reboot<br>
                            <span>N</span>o patch available yet<br>
                            <span>A</span>pplication compatibility issues<br>
                            <span>P</span>rocess/change window constraints
                        </div>
                    </div>
                </div>

                <h2>Types of Compensating Controls</h2>

                <div class="memory-box">
                    <div class="memory-box-title">üß† Control Categories: "NAMED"</div>
                    <div class="mnemonic">
                        <div class="mnemonic-letters">N A M E D</div>
                        <div class="mnemonic-meaning">
                            <span>N</span>etwork ‚Üí <span>A</span>ccess ‚Üí <span>M</span>onitoring ‚Üí <span>E</span>ndpoint ‚Üí <span>D</span>ata
                        </div>
                    </div>
                </div>

                <h3>1. Network Controls</h3>
                <table>
                    <thead><tr><th>Control</th><th>Description</th><th>When to Use</th></tr></thead>
                    <tbody>
                        <tr><td><strong>Firewall Rules</strong></td><td>Block vulnerable port/protocol</td><td>Network-exploitable vuln (SMB, RDP)</td></tr>
                        <tr><td><strong>Network Segmentation</strong></td><td>Isolate vulnerable systems</td><td>Can't patch legacy systems</td></tr>
                        <tr><td><strong>WAF Rules</strong></td><td>Block exploit patterns</td><td>Web app vulnerabilities</td></tr>
                        <tr><td><strong>IPS Signatures</strong></td><td>Detect/block exploit attempts</td><td>Known exploit patterns</td></tr>
                        <tr><td><strong>VPN/Jump Host</strong></td><td>Require authenticated access</td><td>Remove from direct internet</td></tr>
                    </tbody>
                </table>

                <div class="story-scenario">
                    <div class="story-scenario-header">Example: EternalBlue Without Patching</div>
                    <p>
                        <strong>Situation:</strong> Legacy Windows 2008 server can't be patched due to app compatibility.<br><br>
                        <strong>Compensating Controls Applied:</strong><br>
                        ‚úÖ Block port 445 at network level (firewall)<br>
                        ‚úÖ Move to isolated VLAN (segmentation)<br>
                        ‚úÖ IPS rule to detect EternalBlue exploit attempts<br>
                        ‚úÖ Enhanced logging and SIEM alerting<br>
                        ‚úÖ Documented risk acceptance with 90-day review<br><br>
                        <em>Result: Vulnerability contained while planning system replacement</em>
                    </p>
                </div>

                <h3>2. Access Controls</h3>
                <table>
                    <thead><tr><th>Control</th><th>Description</th><th>Example</th></tr></thead>
                    <tbody>
                        <tr><td><strong>Disable Service</strong></td><td>Turn off vulnerable component</td><td>Disable Print Spooler for PrintNightmare</td></tr>
                        <tr><td><strong>Remove Internet Access</strong></td><td>Air-gap from internet</td><td>Move behind VPN</td></tr>
                        <tr><td><strong>Restrict Permissions</strong></td><td>Limit who can access</td><td>Remove unnecessary admin rights</td></tr>
                        <tr><td><strong>MFA Enforcement</strong></td><td>Require additional auth</td><td>Add MFA to RDP access</td></tr>
                    </tbody>
                </table>

                <h3>3. Monitoring & Detection</h3>
                <table>
                    <thead><tr><th>Control</th><th>Description</th><th>Tools</th></tr></thead>
                    <tbody>
                        <tr><td><strong>SIEM Rules</strong></td><td>Alert on exploit indicators</td><td>Splunk, Sentinel, QRadar</td></tr>
                        <tr><td><strong>EDR Detections</strong></td><td>Endpoint-level exploit detection</td><td>CrowdStrike, Defender, Cortex</td></tr>
                        <tr><td><strong>Log Analysis</strong></td><td>Hunt for IOCs in logs</td><td>ELK, Splunk searches</td></tr>
                        <tr><td><strong>File Integrity</strong></td><td>Alert on unauthorized changes</td><td>OSSEC, Tripwire</td></tr>
                    </tbody>
                </table>

                <h3>4. Endpoint Controls</h3>
                <table>
                    <thead><tr><th>Control</th><th>Description</th><th>Example</th></tr></thead>
                    <tbody>
                        <tr><td><strong>Registry Hardening</strong></td><td>Disable vuln via registry</td><td>DisableBasicAuth, DisableLMHash</td></tr>
                        <tr><td><strong>Remove Component</strong></td><td>Delete vulnerable file/feature</td><td>Delete JndiLookup.class</td></tr>
                        <tr><td><strong>Application Whitelist</strong></td><td>Block unauthorized executions</td><td>AppLocker, WDAC</td></tr>
                        <tr><td><strong>Host Firewall</strong></td><td>Block at endpoint level</td><td>Windows Firewall rules</td></tr>
                    </tbody>
                </table>

                <h2>PCI DSS Compensating Control Requirements</h2>

                <div class="info-box warning">
                    <div class="info-box-title">‚ö†Ô∏è PCI DSS Rules for Compensating Controls</div>
                    <p>If you're in a PCI environment, compensating controls MUST:</p>
                    <ol>
                        <li><strong>Meet intent</strong> of original requirement</li>
                        <li><strong>Provide similar</strong> level of defense</li>
                        <li><strong>Go above and beyond</strong> other PCI requirements</li>
                        <li><strong>Be documented</strong> with justification</li>
                        <li><strong>Be reviewed</strong> annually at minimum</li>
                    </ol>
                </div>

                <h2>Compensating Control Documentation Template</h2>

                <div class="code-block">
                    <div class="code-header">Required Documentation</div>
                    <pre><code>COMPENSATING CONTROL DOCUMENTATION
===================================

1. VULNERABILITY DETAILS
   - CVE/Vuln ID: [CVE-XXXX-XXXXX]
   - Severity: [Critical/High/Medium]
   - Affected Systems: [List]
   - Asset Tier: [1-4]

2. REASON FOR COMPENSATING CONTROL
   [ ] No patch available
   [ ] System cannot be rebooted
   [ ] Application compatibility
   [ ] Change window constraints
   [ ] Legacy system - EOL
   Other: _______________________

3. COMPENSATING CONTROLS IMPLEMENTED
   Network Controls:
   [ ] Firewall rule - Block port ____
   [ ] Network segmentation - VLAN ____
   [ ] WAF rule - Pattern: ____
   [ ] IPS signature enabled
   
   Access Controls:
   [ ] Service disabled
   [ ] Internet access removed
   [ ] Permissions restricted
   [ ] MFA enabled
   
   Monitoring:
   [ ] SIEM alert created
   [ ] EDR detection rule
   [ ] Enhanced logging enabled

4. RESIDUAL RISK ASSESSMENT
   Risk Level After Controls: [High/Medium/Low]
   Justification: _______________________

5. REVIEW SCHEDULE
   Next Review Date: ____________
   Responsible Party: ____________
   
6. APPROVAL
   Approved By: ____________
   Date: ____________
   Expiration: ____________</code></pre>
                </div>

                <h2>Common Mistakes to Avoid</h2>

                <div class="comparison-table">
                    <div class="comparison-card bad">
                        <div class="comparison-card-title">‚ùå Wrong Approach</div>
                        <ul>
                            <li>"We'll monitor it" with no specific alerts</li>
                            <li>No documentation of controls</li>
                            <li>No expiration/review date</li>
                            <li>Controls don't address attack vector</li>
                            <li>No approval from risk owner</li>
                        </ul>
                    </div>
                    <div class="comparison-card good">
                        <div class="comparison-card-title">‚úÖ Right Approach</div>
                        <ul>
                            <li>Specific SIEM queries and alert thresholds</li>
                            <li>Full documentation with evidence</li>
                            <li>90-day max review cycle</li>
                            <li>Controls directly mitigate the exploit path</li>
                            <li>Risk owner sign-off documented</li>
                        </ul>
                    </div>
                </div>

                <h2>Interview Questions</h2>

                <div class="info-box interview">
                    <div class="info-box-title">üíº Interview Q&A</div>
                    <p>
                        <strong>Q: "When would you use a compensating control instead of patching?"</strong><br><br>
                        "Compensating controls are appropriate when patching isn't immediately possible - using the SNAP framework: System too critical to reboot during business hours, No patch available yet, Application compatibility prevents the update, or Process constraints like change windows. The key is that compensating controls should match the risk level and be temporary with a documented review cycle."
                    </p>
                    <br>
                    <p>
                        <strong>Q: "Give an example of a compensating control."</strong><br><br>
                        "For PrintNightmare on a print server we couldn't immediately patch, we implemented: 1) Disabled the Print Spooler on non-print servers, 2) Restricted driver installation to admins via Group Policy, 3) Network ACLs limiting Spooler access, 4) SIEM alerts for suspicious spoolsv.exe behavior, and 5) EDR rules blocking known PrintNightmare IOCs. This was documented with a 30-day review until the patch could be applied in the maintenance window."
                    </p>
                </div>

                <div class="page-navigation">
                    <a href="5-8-metrics.html" class="page-nav-link prev">
                        <span class="page-nav-label">‚Üê Previous</span>
                        <span class="page-nav-title">Remediation Metrics</span>
                    </a>
                    <a href="6-1-soar-integration.html" class="page-nav-link next">
                        <span class="page-nav-label">Next ‚Üí</span>
                        <span class="page-nav-title">SOAR Integration</span>
                    </a>
                </div>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
