<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cortex XSOAR for Vulnerability Management - Playbooks, integrations, and automated vulnerability workflows.">
    <title>Cortex XSOAR | VM Docs</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ›¡ï¸</text></svg>">
</head>
<body>
    <div class="reading-progress">
        <div class="reading-progress-bar"></div>
    </div>
    
    <button class="mobile-menu-toggle" aria-label="Toggle menu">â˜°</button>
    
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="sidebar-logo-icon">ğŸ›¡ï¸</div>
                    <div class="sidebar-logo-text"><span>VM</span>DOCS</div>
                </a>
            </div>
                                    <nav class="sidebar-nav">
                <div class="nav-section collapsed" data-section="1">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ“š</span>
                        <span>1. Fundamentals</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="1-1-introduction.html" class="nav-item">1.1 Introduction</a>
                        <a href="1-2-program-framework.html" class="nav-item">1.2 Framework</a>
                        <a href="1-3-scoring-systems.html" class="nav-item">1.3 Scoring</a>
                        <a href="1-4-compliance.html" class="nav-item">1.4 Compliance</a>
                        <a href="1-5-metrics-kpis.html" class="nav-item">1.5 Metrics</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="2">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ”</span>
                        <span>2. Scanning</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="2-1-scanner-types.html" class="nav-item">2.1 Scanner Types</a>
                        <a href="2-2-nessus.html" class="nav-item">2.2 Nessus</a>
                        <a href="2-3-qualys.html" class="nav-item">2.3 Qualys</a>
                        <a href="2-4-rapid7.html" class="nav-item">2.4 Rapid7</a>
                        <a href="2-5-defender.html" class="nav-item">2.5 Defender</a>
                        <a href="2-6-opensource.html" class="nav-item">2.6 Open Source</a>
                        <a href="2-7-best-practices.html" class="nav-item">2.7 Best Practices</a>
                        <a href="2-8-authenticated.html" class="nav-item">2.8 Authenticated</a>
                        <a href="2-9-cloud-container.html" class="nav-item">2.9 Cloud/Container</a>
                        <a href="2-10-webapp.html" class="nav-item">2.10 Web App</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="3">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ“¦</span>
                        <span>3. Assets</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="3-1-discovery-methods.html" class="nav-item">3.1 Discovery</a>
                        <a href="3-2-inventory-management.html" class="nav-item">3.2 Inventory</a>
                        <a href="3-3-cmdb-integration.html" class="nav-item">3.3 CMDB</a>
                        <a href="3-4-cloud-discovery.html" class="nav-item">3.4 Cloud</a>
                        <a href="3-5-shadow-it.html" class="nav-item">3.5 Shadow IT</a>
                        <a href="3-6-classification.html" class="nav-item">3.6 Classification</a>
                        <a href="3-7-attack-surface.html" class="nav-item">3.7 Attack Surface</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="4">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ¯</span>
                        <span>4. Analysis</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="4-1-prioritization.html" class="nav-item">4.1 Prioritization</a>
                        <a href="4-2-risk-scoring.html" class="nav-item">4.2 Risk Scoring</a>
                        <a href="4-3-threat-intel.html" class="nav-item">4.3 Threat Intel</a>
                        <a href="4-4-exploit-prediction.html" class="nav-item">4.4 EPSS</a>
                        <a href="4-5-business-context.html" class="nav-item">4.5 Business Context</a>
                        <a href="4-6-exceptions.html" class="nav-item">4.6 Exceptions</a>
                        <a href="4-7-risk-acceptance.html" class="nav-item">4.7 Risk Acceptance</a>
                        <a href="4-8-zero-day-response.html" class="nav-item">4.8 Zero-Day</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="5">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ”§</span>
                        <span>5. Remediation</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="5-1-remediation-strategies.html" class="nav-item">5.1 Strategies</a>
                        <a href="5-2-patch-management.html" class="nav-item">5.2 Patching</a>
                        <a href="5-3-change-management.html" class="nav-item">5.3 Change Mgmt</a>
                        <a href="5-4-ticket-workflows.html" class="nav-item">5.4 Tickets</a>
                        <a href="5-5-sla-management.html" class="nav-item">5.5 SLAs</a>
                        <a href="5-6-verification.html" class="nav-item">5.6 Verification</a>
                        <a href="5-7-rollback.html" class="nav-item">5.7 Rollback</a>
                        <a href="5-8-metrics.html" class="nav-item">5.8 Metrics</a>
                        <a href="5-9-compensating-controls.html" class="nav-item">5.9 Compensating</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="6">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">âš¡</span>
                        <span>6. Automation</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="6-1-soar-integration.html" class="nav-item">6.1 SOAR</a>
                        <a href="6-2-ticketing-integration.html" class="nav-item">6.2 Ticketing</a>
                        <a href="6-3-api-integration.html" class="nav-item">6.3 APIs</a>
                        <a href="6-4-workflow-automation.html" class="nav-item">6.4 Workflows</a>
                        <a href="6-5-reporting-automation.html" class="nav-item">6.5 Reports</a>
                        <a href="6-6-notifications.html" class="nav-item">6.6 Alerts</a>
                        <a href="6-7-cicd-integration.html" class="nav-item">6.7 CI/CD</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="7">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ›</span>
                        <span>7. Vuln Types</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="7-1-os-vulnerabilities.html" class="nav-item">7.1 OS</a>
                        <a href="7-2-application-vulns.html" class="nav-item">7.2 Apps</a>
                        <a href="7-3-network-device-vulns.html" class="nav-item">7.3 Network</a>
                        <a href="7-4-web-application-vulns.html" class="nav-item">7.4 Web</a>
                        <a href="7-5-container-vulns.html" class="nav-item">7.5 Containers</a>
                        <a href="7-6-cloud-vulns.html" class="nav-item">7.6 Cloud</a>
                        <a href="7-7-database-vulns.html" class="nav-item">7.7 Database</a>
                        <a href="7-8-iot-ot-vulns.html" class="nav-item">7.8 IoT/OT</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="8">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ“Š</span>
                        <span>8. Reporting</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="8-1-dashboards.html" class="nav-item">8.1 Dashboards</a>
                        <a href="8-2-executive-reporting.html" class="nav-item">8.2 Executive</a>
                        <a href="8-3-operational-reporting.html" class="nav-item">8.3 Operational</a>
                        <a href="8-4-compliance-reporting.html" class="nav-item">8.4 Compliance</a>
                        <a href="8-5-kpis-metrics.html" class="nav-item">8.5 KPIs</a>
                    </div>
                </div>
                <div class="nav-section" data-section="9">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ”Œ</span>
                        <span>9. Tools</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="9-1-splunk-vm.html" class="nav-item">9.1 Splunk</a>
                        <a href="9-2-sentinel-vm.html" class="nav-item">9.2 Sentinel</a>
                        <a href="9-3-cortex-xsoar.html" class="nav-item active">9.3 XSOAR</a>
                        <a href="9-4-tenable.html" class="nav-item">9.4 Tenable</a>
                        <a href="9-5-qualys.html" class="nav-item">9.5 Qualys</a>
                    </div>
                </div>
                <div class="nav-section collapsed" data-section="10">
                    <div class="nav-section-header">
                        <span class="nav-section-icon">ğŸ“</span>
                        <span>10. Interview</span>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="10-1-common-questions.html" class="nav-item">10.1 Q&A</a>
                        <a href="10-2-scenario-questions.html" class="nav-item">10.2 Scenarios</a>
                        <a href="10-3-technical-deep-dive.html" class="nav-item">10.3 Technical</a>
                        <a href="10-4-study-guide.html" class="nav-item">10.4 Study Guide</a>
                        <a href="10-5-interview-scenarios.html" class="nav-item">10.5 Deep Dives</a>
                    </div>
                </div>
            </nav>
        </aside>
        
        <main class="main-content">
            <div class="content-wrapper">

                <div class="memory-box">
                    <div class="memory-box-title">ğŸ§  XSOAR Key Concepts</div>
                    <p>
                        <strong>Playbook:</strong> Automated workflow<br>
                        <strong>Incident:</strong> Security event to investigate<br>
                        <strong>Integration:</strong> Connection to external tool<br>
                        <strong>War Room:</strong> Collaboration space<br>
                        XSOAR = Cortex SOAR (Palo Alto)
                    </p>
                </div>

                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">â€º</span>
                    <a href="9-1-splunk-vm.html">Section 9: Tools Deep Dive</a>
                    <span class="breadcrumb-separator">â€º</span>
                    <span class="breadcrumb-current">Cortex XSOAR</span>
                </nav>
                
                <header class="page-header">
                    <h1>Cortex XSOAR for VM</h1>
                    <div class="page-meta">
                        <span class="page-meta-item">ğŸ“– Section 9.3</span>
                        <span class="page-meta-item">â±ï¸ 14 min read</span>
                    </div>
                </header>
                
                <div class="info-box overview" data-label="Overview">
                    <div class="info-box-title">ğŸ“˜ What You'll Learn</div>
                    <p>
                        This page covers using Cortex XSOAR for vulnerability management automation 
                        including playbook design, integrations, and common use cases.
                    </p>
                </div>
                
                <h2>XSOAR VM Architecture</h2>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">Text</span>
                        <button class="code-block-copy"><span>ğŸ“‹</span> Copy</button>
                    </div>
                    <pre><code>XSOAR VULNERABILITY MANAGEMENT ARCHITECTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         CORTEX XSOAR                â”‚
                    â”‚                                     â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                    â”‚  â”‚       PLAYBOOKS             â”‚   â”‚
                    â”‚  â”‚  â€¢ Vuln Enrichment          â”‚   â”‚
                    â”‚  â”‚  â€¢ Ticket Creation          â”‚   â”‚
                    â”‚  â”‚  â€¢ Priority Calculation     â”‚   â”‚
                    â”‚  â”‚  â€¢ Verification             â”‚   â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                    â”‚                                     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”        â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                   â”‚        â”‚                   â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    SCANNERS     â”‚  â”‚   THREAT    â”‚  â”‚    TICKETING    â”‚
     â”‚                 â”‚  â”‚   INTEL     â”‚  â”‚                 â”‚
     â”‚ â€¢ Tenable.io    â”‚  â”‚ â€¢ CISA KEV  â”‚  â”‚ â€¢ ServiceNow    â”‚
     â”‚ â€¢ Qualys        â”‚  â”‚ â€¢ EPSS      â”‚  â”‚ â€¢ Jira          â”‚
     â”‚ â€¢ Rapid7        â”‚  â”‚ â€¢ VirusTotalâ”‚  â”‚ â€¢ Custom        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

KEY INTEGRATIONS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Vulnerability Scanners:
  â€¢ Tenable.io, Tenable.sc
  â€¢ Qualys VMDR
  â€¢ Rapid7 InsightVM

Threat Intelligence:
  â€¢ CISA KEV
  â€¢ EPSS
  â€¢ NVD
  â€¢ Recorded Future

Ticketing/ITSM:
  â€¢ ServiceNow
  â€¢ Jira
  â€¢ BMC Remedy

Asset Management:
  â€¢ ServiceNow CMDB
  â€¢ Cortex XDR (assets)</code></pre>
                </div>
                
                <h2>Playbook Examples</h2>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">YAML</span>
                        <button class="code-block-copy"><span>ğŸ“‹</span> Copy</button>
                    </div>
                    <pre><code># XSOAR Playbook: Vulnerability Triage and Ticketing
# Triggered by: New vulnerability incident

tasks:
  start:
    name: Start
    nexttasks:
      - get_vuln_details
      
  get_vuln_details:
    name: Get Vulnerability Details
    task:
      script: Tenable.io|||tenable-io-get-vulnerability-details
    scriptarguments:
      plugin_id: ${incident.plugin_id}
    nexttasks:
      - enrich_with_kev
      
  enrich_with_kev:
    name: Check CISA KEV
    task:
      script: CISAKEV|||cisa-kev-check
    scriptarguments:
      cve: ${TenableIO.Vulnerability.cve}
    nexttasks:
      - get_epss
      
  get_epss:
    name: Get EPSS Score
    task:
      script: EPSS|||epss-score-get
    scriptarguments:
      cve: ${TenableIO.Vulnerability.cve}
    nexttasks:
      - get_asset_info
      
  get_asset_info:
    name: Get Asset from CMDB
    task:
      script: ServiceNow|||servicenow-get-record
    scriptarguments:
      table_name: cmdb_ci
      query: ip_address=${incident.asset_ip}
    nexttasks:
      - calculate_priority
      
  calculate_priority:
    name: Calculate Risk Priority
    task:
      script: CalculateVulnPriority
    scriptarguments:
      cvss: ${TenableIO.Vulnerability.cvss_score}
      epss: ${EPSS.score}
      kev: ${CISAKEV.in_catalog}
      asset_tier: ${ServiceNow.Record.u_criticality}
    nexttasks:
      - create_ticket
      
  create_ticket:
    name: Create Remediation Ticket
    task:
      script: Jira|||jira-create-issue
    scriptarguments:
      summary: "[${CalculatedPriority.priority}] ${incident.cve_id}"
      priority: ${CalculatedPriority.jira_priority}
      description: |
        Vulnerability: ${incident.cve_id}
        CVSS: ${TenableIO.Vulnerability.cvss_score}
        EPSS: ${EPSS.score}
        KEV: ${CISAKEV.in_catalog}
        Asset: ${incident.hostname}
      assignee: ${ServiceNow.Record.assigned_to}
    nexttasks:
      - notify_owner
      
  notify_owner:
    name: Send Notification
    task:
      script: SendEmail
    scriptarguments:
      to: ${ServiceNow.Record.assigned_to_email}
      subject: "New Vulnerability Ticket: ${Jira.Key}"</code></pre>
                </div>
                
                <h2>Custom Script Example</h2>
                
                <div class="code-block">
                    <div class="code-block-header">
                        <span class="code-block-lang">Python</span>
                        <button class="code-block-copy"><span>ğŸ“‹</span> Copy</button>
                    </div>
                    <pre><code>"""
XSOAR Automation Script: CalculateVulnPriority
Calculates risk-based priority for vulnerability triage.
"""

import demistomock as demisto
from CommonServerPython import *


def calculate_priority(cvss, epss, kev, asset_tier):
    """Calculate vulnerability priority based on risk factors."""
    
    score = 0
    
    # CVSS contribution (0-30 points)
    score += (float(cvss) / 10) * 30
    
    # EPSS contribution (0-25 points)
    epss_val = float(epss) if epss else 0
    if epss_val > 0.1:
        score += 25
    elif epss_val > 0.01:
        score += 15
    elif epss_val > 0.001:
        score += 5
    
    # KEV boost (25 points)
    if kev and str(kev).lower() == 'true':
        score += 25
    
    # Asset criticality multiplier
    tier_multipliers = {'1': 1.5, '2': 1.2, '3': 1.0, '4': 0.8}
    multiplier = tier_multipliers.get(str(asset_tier), 1.0)
    score *= multiplier
    
    # Determine priority
    if score >= 80 or (kev and str(kev).lower() == 'true'):
        priority = 'P1'
        jira_priority = 'Highest'
        sla_days = 2
    elif score >= 60:
        priority = 'P2'
        jira_priority = 'High'
        sla_days = 7
    elif score >= 40:
        priority = 'P3'
        jira_priority = 'Medium'
        sla_days = 30
    else:
        priority = 'P4'
        jira_priority = 'Low'
        sla_days = 90
    
    return {
        'priority': priority,
        'score': round(score, 1),
        'jira_priority': jira_priority,
        'sla_days': sla_days
    }


def main():
    args = demisto.args()
    
    result = calculate_priority(
        cvss=args.get('cvss', 5.0),
        epss=args.get('epss', 0.01),
        kev=args.get('kev', 'false'),
        asset_tier=args.get('asset_tier', '3')
    )
    
    return_results(CommandResults(
        outputs_prefix='CalculatedPriority',
        outputs=result
    ))


if __name__ in ('__main__', '__builtin__', 'builtins'):
    main()</code></pre>
                </div>
                
                <div class="info-box interview" data-label="Interview">
                    <div class="info-box-title">ğŸ’¡ Interview Question</div>
                    <p>
                        <strong>"How have you used XSOAR for vulnerability management automation?"</strong><br><br>
                        Sample answer: "I built XSOAR playbooks that automate vulnerability triage. When a 
                        new critical vulnerability is detected, the playbook enriches it with CISA KEV status 
                        and EPSS scores, pulls asset context from ServiceNow CMDB, calculates a risk-based 
                        priority, creates a Jira ticket assigned to the asset owner, and sends notification. 
                        This reduced manual triage from 15 minutes per vulnerability to automated processing 
                        in under a minute. I also built verification playbooks that trigger rescans after 
                        tickets are marked remediated."
                    </p>
                </div>
                
                <h2>Summary</h2>
                
                <p>
                    Cortex XSOAR transforms vulnerability management from manual triage to automated 
                    workflows. Build playbooks for enrichment, ticket creation, and verification. 
                    Integrate with scanners, threat intel, CMDB, and ticketing systems for end-to-end 
                    automation.
                </p>
                
                <nav class="page-navigation">
                    <a href="9-2-sentinel-vm.html" class="page-nav-link prev">
                        <span class="page-nav-label">â† Previous</span>
                        <span class="page-nav-title">Sentinel for VM</span>
                    </a>
                    <a href="9-4-tenable.html" class="page-nav-link next">
                        <span class="page-nav-label">Next â†’</span>
                        <span class="page-nav-title">Tenable Deep Dive</span>
                    </a>
                </nav>
            </div>
        </main>
    </div>
    
    <script src="main.js"></script>
</body>
</html>
